<div class=" header bg-success pb-6">
  <div class=" container-fluid">
    <div class=" header-body">
      <div class=" row align-items-center py-4">
        <div class=" col-lg-6 col-7">
          <h6 class=" h2 text-white d-inline-block mb-0">Create Entity View</h6>
          <nav aria-label="breadcrumb" class=" d-none d-md-inline-block ml-md-4"></nav>
        </div>
        <div class=" col-lg-6 col-5 text-right">
        </div>
      </div>
    </div>
  </div>
</div>
<div class=" container-fluid mt--6">
  <div class=" row justify-content-center">
    <div class=" col-lg-11 card-wrapper">
      <div class="card">
        <div class="card-header" style="padding: 10px">
          <h3 style="font-family: Open Sans, sans-serif; text-align: center">Add New Entity View</h3>
        </div>
        <div class="card-body" style="font-size: 0.9rem;">
          <form [formGroup]="formGroup" (ngSubmit)="createEntityView()" *ngIf="formGroup">
            <div class="row">
              <div class="col-md-12" style="padding-left: 30px;padding-top: 15px">
                <div class="row">
                  <div class="col-md-4" style="padding-top: 5px;">
                    <label>
                      Name
                      <span class="required-indicator">*</span>
                    </label>
                  </div>
                  <div class="col-md-5">
                    <div class="col-md-12">
                      <div class="form-group ">
                        <div class=" input-group input-group-merge">
                          <input
                            class="form-control"
                            placeholder="Name"
                            type="text"
                            style="padding-left: 10px;"
                            formControlName="name"
                            [ngClass]="{ 'is-invalid': submitted && f.name.errors }"
                          >
                          <div *ngIf="submitted && f.name.errors"
                               class="invalid-feedback">
                            <div *ngIf="f.name.errors.required">Name is
                              required
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-4" style="padding-top: 5px;">
                    <label>
                      Description
                      <span class="required-indicator">*</span>
                    </label>
                  </div>
                  <div class="col-md-5">
                    <div class="col-md-12">
                      <div class="form-group ">
                        <div class=" input-group input-group-merge">
                          <input
                            class="form-control"
                            placeholder="Description"
                            type="text"
                            style="padding-left: 10px;"
                            formControlName="description"
                            [ngClass]="{ 'is-invalid': submitted && f.description.errors }"
                          >
                          <div *ngIf="submitted && f.description.errors"
                               class="invalid-feedback">
                            <div *ngIf="f.description.errors.required">Description is
                              required
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-4" style="padding-top: 5px;">
                    <label>
                      View Table Name(should end with `view')
                      <span class="required-indicator">*</span>
                    </label>
                  </div>
                  <div class="col-md-5">
                    <div class="col-md-12">
                      <div class="form-group ">
                        <div class=" input-group input-group-merge">
                          <input
                            class="form-control"
                            placeholder="View Table Name"
                            type="text"
                            style="padding-left: 10px;"
                            formControlName="tableName"
                            [ngClass]="{ 'is-invalid': submitted && f.tableName.errors }"
                          >
                          <div *ngIf="submitted && f.tableName.errors"
                               class="invalid-feedback">
                            <div *ngIf="f.tableName.errors.required">View Table Name is
                              required
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-4" style="padding-top: 5px;">
                    <label>
                      View Query
                      <span class="required-indicator">*</span>
                    </label>
                  </div>
                  <div class="col-md-6">
                    <div class="col-md-12">
                      <div class="form-group ">
                        <div class=" input-group input-group-merge">
                          <textarea class="form-control"
                                    id="queryTextArea"
                                    rows="5"
                                    formControlName="viewQuery"
                                    [ngClass]="{ 'is-invalid': submitted && f.viewQuery.errors }"></textarea>
                          <div *ngIf="submitted && f.viewQuery.errors"
                               class="invalid-feedback">
                            <div *ngIf="f.viewQuery.errors.required">View Query is required
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-12" style="padding-left: 30px;padding-top: 15px">
                <form [formGroup]="formGroupField" (ngSubmit)="addNewEntityField();" *ngIf="formGroupField">
                  <div class="form-row">
                    <div class="form-group col-md-3">
                      <label>Field Name <span class="required-indicator">*</span> </label>
                      <input type="text"
                             class="form-control"
                             placeholder="Field Name"
                             formControlName="name"
                             [ngClass]="{ 'is-invalid': submitFields && fFields.name.errors }">
                      <div *ngIf="submitFields && fFields.name.errors"
                           class="invalid-feedback">
                        <div *ngIf="fFields.name.errors.required">Display Order is
                          required
                        </div>
                      </div>
                    </div>
                    <div class="form-group col-md-3">
                      <label>Field Type <span class="required-indicator">*</span> </label>
                      <ng-select class="form-control form-control-sm"
                                 aria-controls="datatable"
                                 style="height: auto !important; padding: 0; border: 1px solid #f7fafc;"
                                 [multiple]="false"
                                 placeholder=" Field Type"
                                 formControlName="fieldType"
                                 [ngClass]="{ 'is-invalid': submitFields && fFields.fieldType.errors }"
                                 [searchable]="true"
                                 [clearable]="true">
                        <ng-option [value]="item.value" *ngFor="let item of fieldTypes">
                          {{item.name}}
                        </ng-option>
                      </ng-select>
                      <div *ngIf="submitFields && fFields.fieldType.errors" class="invalid-feedback">
                        <div *ngIf="fFields.fieldType.errors.required">Field Type is required</div>
                      </div>
                    </div>
                    <div class="form-group col-md-2">
                      <label>Display Order <span class="required-indicator">*</span> </label>
                      <input type="number"
                             class="form-control"
                             placeholder="Display Order"
                             formControlName="orderOfDisplay"
                             [ngClass]="{ 'is-invalid': submitFields && fFields.orderOfDisplay.errors }">
                      <div *ngIf="submitFields && fFields.orderOfDisplay.errors"
                           class="invalid-feedback">
                        <div *ngIf="fFields.orderOfDisplay.errors.required">Field Name is
                          required
                        </div>
                      </div>
                    </div>
                    <div class="form-group col-md-2">
                      <label>Filter Order <span class="required-indicator">*</span> </label>
                      <input type="number"
                             class="form-control"
                             placeholder="Filter Order"
                             formControlName="filterOrder"
                             [ngClass]="{ 'is-invalid': submitFields && fFields.filterOrder.errors }">
                      <div *ngIf="submitFields && fFields.filterOrder.errors"
                           class="invalid-feedback">
                        <div *ngIf="fFields.filterOrder.errors.required">Filter Order is
                          required
                        </div>
                      </div>
                    </div>
                    <div class="form-group col-md-2 text-left">
                      <button class=" btn btn-default" type="submit" style="margin-top: 30px;">Add Field</button>
                    </div>
                  </div>
                </form>
              </div>
              <div class="col-md-12" style="padding: 20px;">
                <table datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger" class="table table-striped table-bordered" style="width:100%">
                  <thead>
                  <tr>
                    <th>Field Name</th>
                    <th>Field Type</th>
                    <th>Display Order</th>
                    <th>Filter Order</th>
                    <th>Action</th>
                  </tr>
                  </thead>
                  <tbody>
                  <tr *ngFor="let row of rows">
                    <td>{{ row.name }}</td>
                    <td>{{ row.fieldType }}</td>
                    <td>{{ row.orderOfDisplay }}</td>
                    <td>{{ row.filterOrder }}</td>
                    <td></td>
                  </tr>
                  </tbody>
                </table>
              </div>
            </div>
            <div class="row">
              <div class="col-md-12 offset-5" style="padding-bottom: 15px; padding-left: 0px">
                <button class=" btn btn-default" type="submit">Save</button>
                <button class=" btn btn-danger" type="reset" (click)="onReset()">Reset</button>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>

